document.addEventListener("DOMContentLoaded",(function(){function e(e,t){if(Element.prototype.closest)return e.closest(t);do{if(Element.prototype.matches&&e.matches(t)||Element.prototype.msMatchesSelector&&e.msMatchesSelector(t)||Element.prototype.webkitMatchesSelector&&e.webkitMatchesSelector(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}function t(){var e=document.activeElement.getAttribute("id");sessionStorage.setItem("returnFocusTo","#"+e)}Array.prototype.forEach.call(document.querySelectorAll(".share a"),(function(e){e.addEventListener("click",(function(e){e.preventDefault(),window.open(this.href,"","height = 500, width = 500")}))}));var n=sessionStorage.getItem("returnFocusTo");if(n){sessionStorage.removeItem("returnFocusTo");var i=document.querySelector(n);i&&i.focus&&i.focus()}var o=document.querySelector(".comment-container textarea"),s=document.querySelector(".comment-form-controls, .comment-ccs");o&&(o.addEventListener("focus",(function e(){s.style.display="block",o.removeEventListener("focus",e)})),""!==o.value&&(s.style.display="block"));var r=document.querySelector(".request-container .comment-container .comment-show-container"),a=document.querySelectorAll(".request-container .comment-container .comment-fields"),c=document.querySelector(".request-container .comment-container .request-submit-comment");r&&r.addEventListener("click",(function(){r.style.display="none",Array.prototype.forEach.call(a,(function(e){e.style.display="block"})),c.style.display="inline-block",o&&o.focus()}));var u=document.querySelector(".request-container .mark-as-solved:not([data-disabled])"),l=document.querySelector(".request-container .comment-container input[type=checkbox]"),d=document.querySelector(".request-container .comment-container input[type=submit]");u&&u.addEventListener("click",(function(){l.setAttribute("checked",!0),d.disabled=!0,this.setAttribute("data-disabled",!0),e(this,"form").submit()}));var m=document.querySelector(".request-container .comment-container textarea");function h(e){return""===e.trim()}var p=m&&"wysiwyg"===m.dataset.helper?function(e){var t=(new DOMParser).parseFromString(`<_>${e}</_>`,"text/xml");return null===t.querySelector("img")&&h(t.children[0].textContent)}:h;m&&m.addEventListener("input",(function(){p(m.value)?(u&&(u.innerText=u.getAttribute("data-solve-translation")),d.disabled=!0):(u&&(u.innerText=u.getAttribute("data-solve-and-submit-translation")),d.disabled=!1)})),m&&p(m.value)&&(d.disabled=!0),Array.prototype.forEach.call(document.querySelectorAll("#request-status-select, #request-organization-select"),(function(n){n.addEventListener("change",(function(n){n.stopPropagation(),t(),e(this,"form").submit()}))}));var f=document.querySelector("#quick-search");function v(e,t){var n="true"===t.getAttribute("aria-expanded");t.setAttribute("aria-expanded",!n),e.setAttribute("aria-expanded",!n)}function y(e,t){t.setAttribute("aria-expanded",!1),e.setAttribute("aria-expanded",!1),e.focus()}f&&f.addEventListener("keyup",(function(n){13===n.keyCode&&(n.stopPropagation(),t(),e(this,"form").submit())}));var g=document.querySelector(".header .menu-button-mobile"),b=document.querySelector("#user-nav-mobile");g.addEventListener("click",(function(e){e.stopPropagation(),v(this,b)})),b.addEventListener("keyup",(function(e){27===e.keyCode&&(e.stopPropagation(),y(g,this))}));var E=document.querySelectorAll(".collapsible-nav, .collapsible-sidebar");Array.prototype.forEach.call(E,(function(e){var t=e.querySelector(".collapsible-nav-toggle, .collapsible-sidebar-toggle");e.addEventListener("click",(function(e){v(t,this)})),e.addEventListener("keyup",(function(e){27===e.keyCode&&y(t,this)}))}));var k=document.querySelector("#request-organization select");k&&k.addEventListener("change",(function(){e(this,"form").submit()}));var q=document.querySelectorAll(".multibrand-filter-list");Array.prototype.forEach.call(q,(function(e){if(e.children.length>6){var t=e.querySelector(".see-all-filters");t.setAttribute("aria-hidden",!1),t.addEventListener("click",(function(n){n.stopPropagation(),t.parentNode.removeChild(t),e.classList.remove("multibrand-filter-list--collapsed")}))}}));var S=document.querySelector(".notification-error");function w(e,t){this.toggle=e,this.menu=t,this.menuPlacement={top:t.classList.contains("dropdown-menu-top"),end:t.classList.contains("dropdown-menu-end")},this.toggle.addEventListener("click",this.clickHandler.bind(this)),this.toggle.addEventListener("keydown",this.toggleKeyHandler.bind(this)),this.menu.addEventListener("keydown",this.menuKeyHandler.bind(this))}S&&S.previousElementSibling&&"function"==typeof S.previousElementSibling.focus&&S.previousElementSibling.focus(),w.prototype={get isExpanded(){return"true"===this.menu.getAttribute("aria-expanded")},get menuItems(){return Array.prototype.slice.call(this.menu.querySelectorAll("[role='menuitem']"))},dismiss:function(){this.isExpanded&&(this.menu.setAttribute("aria-expanded",!1),this.menu.classList.remove("dropdown-menu-end","dropdown-menu-top"))},open:function(){this.isExpanded||(this.menu.setAttribute("aria-expanded",!0),this.handleOverflow())},handleOverflow:function(){var e=this.menu.getBoundingClientRect(),t=e.left<0||e.left+e.width>window.innerWidth,n=e.top<0||e.top+e.height>window.innerHeight;(t||this.menuPlacement.end)&&this.menu.classList.add("dropdown-menu-end"),(n||this.menuPlacement.top)&&this.menu.classList.add("dropdown-menu-top"),this.menu.getBoundingClientRect().top<0&&this.menu.classList.remove("dropdown-menu-top")},focusNextMenuItem:function(e){if(this.menuItems.length){var t=this.menuItems.indexOf(e),n=t===this.menuItems.length-1||t<0?0:t+1;this.menuItems[n].focus()}},focusPreviousMenuItem:function(e){if(this.menuItems.length){var t=this.menuItems.indexOf(e),n=t<=0?this.menuItems.length-1:t-1;this.menuItems[n].focus()}},clickHandler:function(){this.isExpanded?this.dismiss():this.open()},toggleKeyHandler:function(e){switch(e.keyCode){case 13:case 32:case 40:e.preventDefault(),this.open(),this.focusNextMenuItem();break;case 38:e.preventDefault(),this.open(),this.focusPreviousMenuItem();break;case 27:this.dismiss(),this.toggle.focus()}},menuKeyHandler:function(e){var t=this.menuItems[0],n=this.menuItems[this.menuItems.length-1],i=e.target;switch(e.keyCode){case 27:this.dismiss(),this.toggle.focus();break;case 40:e.preventDefault(),this.focusNextMenuItem(i);break;case 38:e.preventDefault(),this.focusPreviousMenuItem(i);break;case 9:e.shiftKey?i===t?this.dismiss():(e.preventDefault(),this.focusPreviousMenuItem(i)):i===n?this.dismiss():(e.preventDefault(),this.focusNextMenuItem(i));break;case 13:case 32:e.preventDefault(),i.click()}}};var A=[];Array.prototype.slice.call(document.querySelectorAll(".dropdown-toggle")).forEach((function(e){var t=e.nextElementSibling;t&&t.classList.contains("dropdown-menu")&&A.push(new w(e,t))})),document.addEventListener("click",(function(e){A.forEach((function(t){t.toggle.contains(e.target)||t.dismiss()}))}))}));